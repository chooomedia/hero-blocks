{% block sw_cms_block_config_hero_video_extended %}
<div class="sw-cms-block-config-hero-video-extended" v-if="block && block.customFields">
    
    {# File Size Warning Modal #}
    <mt-modal 
        v-if="showFileSizeWarning"
        :title="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.fileSizeWarning.title')"
        variant="small"
        @modal-close="dismissFileSizeWarning"
    >
        <p>{{ $tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.fileSizeWarning.message') }}</p>
        <p class="sw-cms-block-config-hero-video-extended__warning-hint">
            {{ $tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.fileSizeWarning.hint') }}
        </p>
        <template #modal-footer>
            <mt-button variant="primary" @click="dismissFileSizeWarning">
                {{ $tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.fileSizeWarning.understand') }}
            </mt-button>
        </template>
    </mt-modal>

    {# ========== VIDEO SETTINGS ========== #}
    <div class="sw-cms-block-config-hero-video-extended__section">
        <h4 class="sw-cms-block-config-hero-video-extended__section-title">
            {{ $tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.videoSection') }}
        </h4>
        
        {# Video Upload - MP4 und WebM unterstützt #}
        {# WICHTIG: Gleiches Pattern wie Hero Two Columns - source mit { id: ... } Objekt #}
        <sw-media-compact-upload-v2
            :source="block.customFields?.videoMediaId ? { id: block.customFields.videoMediaId } : null"
            :upload-tag="uploadTag + '-video'"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.video')"
            :help-text="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.videoHelp')"
            :default-folder="cmsPageState?.pageEntityName || 'cms_page'"
            :file-accept="videoAccept"
            :allow-multi-select="false"
            @media-upload-remove-image="onRemoveVideo"
            @selection-change="onVideoSelectionChange"
        />
        {# WICHTIG: Separater Upload-Listener wie Hero Two Columns #}
        <sw-upload-listener
            :upload-tag="uploadTag + '-video'"
            auto-upload
            @media-upload-finish="onVideoUploadFinish"
        />
        
        {# Poster Image Upload #}
        <sw-media-compact-upload-v2
            :source="block.customFields?.posterMediaId ? { id: block.customFields.posterMediaId } : null"
            :upload-tag="uploadTag + '-poster'"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.poster')"
            :help-text="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.posterHelp')"
            :default-folder="cmsPageState?.pageEntityName || 'cms_page'"
            :file-accept="'image/*'"
            :allow-multi-select="false"
            @media-upload-remove-image="onRemovePoster"
            @selection-change="onPosterSelectionChange"
        />
        {# WICHTIG: Separater Upload-Listener wie Hero Two Columns #}
        <sw-upload-listener
            :upload-tag="uploadTag + '-poster'"
            auto-upload
            @media-upload-finish="onPosterUploadFinish"
        />
        
        {# Autoplay #}
        <sw-switch-field
            :value="autoplay"
            @update:value="onAutoplayChange"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.autoplay')"
            :helpText="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.autoplayHelp')"
        />
        
        {# Loop #}
        <sw-switch-field
            :value="loop"
            @update:value="onLoopChange"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.loop')"
            :helpText="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.loopHelp')"
        />
        
        {# Muted #}
        <sw-switch-field
            :value="muted"
            @update:value="onMutedChange"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.muted')"
            :helpText="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.mutedHelp')"
        />
        
        {# Min Height #}
        <sw-text-field
            :value="minHeight"
            @update:value="onMinHeightChange"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.minHeight')"
            :helpText="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.minHeightHelp')"
            :placeholder="'500px'"
        />
    </div>
    
    {# ========== OVERLAY POSITION (NICHT übersetzbar) ========== #}
    <div class="sw-cms-block-config-hero-video-extended__section">
        <h4 class="sw-cms-block-config-hero-video-extended__section-title">
            {{ $tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.overlaySection') }}
        </h4>
        
        {# Overlay Position - WICHTIG: mt-select für Shopware 6.7+ #}
        <mt-select
            :model-value="overlayPosition"
            @update:model-value="onOverlayPositionChange"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.overlayPosition')"
            :options="positionOptions"
            :help-text="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.overlayPositionHelp')"
        />
    </div>
    
    {# ========== OVERLAY CONTENT (SPRACHABHÄNGIG) ========== #}
    <div class="sw-cms-block-config-hero-video-extended__section">
        <h4 class="sw-cms-block-config-hero-video-extended__section-title">
            {{ $tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.contentSection') }}
            <span class="sw-cms-block-config-hero-video-extended__language-hint">
                ({{ $tc('sw-cms.elements.general.config.tab.languageDependent') }})
            </span>
        </h4>
        
        {# Overlay Content (HTML) - SPRACHABHÄNGIG (wird im Element-Slot gespeichert) #}
        <sw-text-editor
            :value="overlayContent"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.overlayContent')"
            :placeholder="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.overlayContentPlaceholder')"
            :sanitize-input="false"
            :sanitize-field-value="false"
            :allow-inline-data-mapping="false"
            :is-inline-edit="false"
            @update:value="onOverlayContentChange"
        />
    </div>
    
    {# ========== STYLE SETTINGS ========== #}
    <div class="sw-cms-block-config-hero-video-extended__section">
        <h4 class="sw-cms-block-config-hero-video-extended__section-title">
            {{ $tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.styleSection') }}
        </h4>
        
        {# Overlay Background Color #}
        <sw-colorpicker
            :value="overlayBackgroundColor"
            @update:value="onOverlayBackgroundColorChange"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.overlayBackgroundColor')"
            :helpText="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.overlayBackgroundColorHelp')"
            :colorOutput="'hex'"
        />
        
        {# Overlay Text Color #}
        <sw-colorpicker
            :value="overlayTextColor"
            @update:value="onOverlayTextColorChange"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.overlayTextColor')"
            :colorOutput="'hex'"
        />
    </div>
    
    {# ========== ANIMATION SETTINGS ========== #}
    <div class="sw-cms-block-config-hero-video-extended__section">
        <h4 class="sw-cms-block-config-hero-video-extended__section-title">
            {{ $tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.animationSection') }}
        </h4>
        
        {# Enable Scroll Animation #}
        <sw-switch-field
            :value="enableScrollAnimation"
            @update:value="onEnableScrollAnimationChange"
            :label="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.enableScrollAnimation')"
            :helpText="$tc('sw-cms.blocks.heroBlocks.heroVideoExtended.config.enableScrollAnimationHelp')"
        />
    </div>
    
</div>
{% endblock %}
